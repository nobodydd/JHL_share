{"version":3,"sources":["webpack:///./src/components/xt/page/home/index.vue?afcf","webpack:///./src/components/xt/services/loginService.js","webpack:///src/components/xt/page/home/index.vue","webpack:///./src/components/xt/page/home/index.vue?4e3d","webpack:///./src/components/xt/page/home/index.vue?f0a7","webpack:///./src/components/xt/page/home/index.vue?0637","webpack:///./src/components/xt/assets/imgs/common/no_unable_load_img.png"],"names":["render","_vm","this","_h","$createElement","_c","_self","directives","name","rawName","value","expression","staticClass","attrs","defaultImg","_v","on","refresh","goBack","staticRenderFns","getControlTokenService","params","http","get","getSystemDicByParent","baseUrl","parentId","pageSize","pageNum","data","showErrorPage","userInfo","created","hrefStr","localStorage","setItem","computed","methods","$router","back","areaList","length","selectedArea","getSystemAreaList","areaCode","AREA_CODE","controlToken","$s_code_$exp","getControlToken","jumpPage","setAreaCode","forEach","newE","$toast","roleId","userCode","OWNER_CODE","phone","PHONE","ownerName","OWNER_NAME","ownerNickName","OWNER_NICK_NAME","push","component","module","exports"],"mappings":"gJAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASC,MAAOT,EAAiB,cAAEU,WAAW,kBAAkBC,YAAY,cAAc,CAACP,EAAG,MAAM,CAACO,YAAY,eAAe,CAACP,EAAG,MAAM,CAACQ,MAAM,CAAC,IAAMZ,EAAIa,WAAW,IAAM,QAAQT,EAAG,MAAM,CAACO,YAAY,oBAAoB,CAACX,EAAIc,GAAG,aAAaV,EAAG,MAAM,CAACO,YAAY,eAAe,CAACP,EAAG,MAAM,CAACO,YAAY,MAAMI,GAAG,CAAC,MAAQf,EAAIgB,UAAU,CAAChB,EAAIc,GAAG,UAAUV,EAAG,MAAM,CAACO,YAAY,MAAMI,GAAG,CAAC,MAAQf,EAAIiB,SAAS,CAACjB,EAAIc,GAAG,eACtiBI,EAAkB,G,gFCEhBC,EAAyB,SAACC,GAAD,OAAaC,OAAKC,IAAI,qCAAsCF,IAGrFG,EAAuB,kBAAOF,OAAKC,IAAIE,OAAU,uDAAwD,CAAEC,SAAU,KAAMC,SAAU,MAAMC,QAAQ,O,ymBCkBzJ,OACEC,KADF,WAEI,MAAO,CACLf,WAAY,EAAlB,EACMgB,eAAe,EACfC,SAAN,KAGEC,QARF,WASI,IAAJ,kCACIC,EAAJ,kDACI/B,KAAK6B,SAAT,cACIG,aAAaC,QAAQ,WAAzB,eAEIjC,KAAKe,WAGPmB,SAAU,EAAZ,GACA,gBACI,SAAJ,YAAM,OAAN,uBACI,SAAJ,YAAM,OAAN,0BAIEC,QAAS,EAAX,GACA,8CADA,CAEInB,OAFJ,WAGMhB,KAAKoC,QAAQC,QAIftB,QAPJ,WAQUf,KAAKsC,SAASC,OAChBvC,KAAKwC,eAELxC,KAAKyC,qBAITA,kBAfJ,WAeA,WACM,IACN,kBACQ,EAAR,iBACQ,QAAR,uBACQ,EAAR,yBACQ,EAAR,kBAEA,mBACQ,EAAR,iBACQ,GAAR,YACQ,QAAR,2BAKID,aA/BJ,WA+BA,WAEM,GAAIxC,KAAK0C,WAAa1C,KAAK6B,SAASc,UAAW,CAC7C,IAAR,oCACaC,EAAaC,aAIhB7C,KAAK8C,iBAAgB,WACnB,EAAZ,cAHU9C,KAAK+C,gBAQP/C,KAAKgD,YAAY,IACjBhD,KAAKsC,SAASW,SAAQ,SAA9B,GACU,IAAV,uBACcC,EAAKP,YAAc,EAAjC,qBAEY,EAAZ,yBACY,EAAZ,4CACY,EAAZ,4BACc,EAAd,kBAKa3C,KAAK0C,WACR1C,KAAK4B,eAAgB,EACrB5B,KAAKmD,OAAO,eAMlBL,gBAlEJ,SAkEA,cACA,GACQM,OAAQ,IACRC,SAAUrD,KAAK6B,SAASyB,WACxBC,MAAOvD,KAAK6B,SAAS2B,MACrBC,UAAWzD,KAAK6B,SAAS6B,WACzBC,cAAe3D,KAAK6B,SAAS+B,iBAE/B,EAAN,GACA,kBAEQ,GADA,QAAR,2BACA,cAAU,IAEV,eACU,EAAV,sCACU,GAAV,SAEU,EAAV,iBACU,EAAV,gCAGA,mBACQ,QAAR,2BACQ,EAAR,iBACQ,EAAR,4BAIIb,SA9FJ,WA+FM/C,KAAKoC,QAAQyB,KAAK,CAAxB,sBC/I4X,I,wBCQxXC,EAAY,eACd,EACAhE,EACAmB,GACA,EACA,KACA,WACA,MAIa,aAAA6C,E,6CCnBf,yBAA8lB,EAAG,G,qBCAjmBC,EAAOC,QAAU,IAA0B","file":"www/js/chunk-887ab288.c39091d8.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showErrorPage),expression:\"showErrorPage\"}],staticClass:\"fault-page\"},[_c('div',{staticClass:\"content-img\"},[_c('img',{attrs:{\"src\":_vm.defaultImg,\"alt\":\"\"}})]),_c('div',{staticClass:\"content-describe\"},[_vm._v(\"哎呀，报错了…\")]),_c('div',{staticClass:\"btn-content\"},[_c('div',{staticClass:\"btn\",on:{\"click\":_vm.refresh}},[_vm._v(\"刷新页面\")]),_c('div',{staticClass:\"btn\",on:{\"click\":_vm.goBack}},[_vm._v(\"返回主页\")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import http from \"../http\";\nimport baseUrl from '../config'\n//获取管控平台token\nconst getControlTokenService = (params) => (http.get('/web/new/api/user/appOwnerLoginNew', params));\n\n// 获取管控平台小区列表\nconst getSystemDicByParent = () => (http.get(baseUrl + '/subsystem/system/dic/getSystemDicByParentIdContent1', { parentId: 'PH', pageSize: '100',pageNum:'1'}));\n\nexport {\n    getSystemDicByParent,\n    getControlTokenService\n}","<template>\n  <!-- 本页面就是一个空页面，用来跳转其他页面 -->\n  <div class=\"fault-page\" v-show=\"showErrorPage\">\n    <div class=\"content-img\">\n      <img :src=\"defaultImg\" alt />\n    </div>\n    <!-- 提示 -->\n    <div class=\"content-describe\">哎呀，报错了…</div>\n    <!-- 操作按钮 -->\n    <div class=\"btn-content\">\n      <div class=\"btn\" @click=\"refresh\">刷新页面</div>\n      <div class=\"btn\" @click=\"goBack\">返回主页</div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {\n  getSystemDicByParent,\n  getControlTokenService\n} from \"xt/services/loginService\";\nimport defaultImg from \"xt/assets/imgs/common/no_unable_load_img.png\";\nimport { store, storage } from \"@/utils/store\";\nimport { mapState, mapMutations } from \"vuex\";\nexport default {\n  data() {\n    return {\n      defaultImg: defaultImg,\n      showErrorPage: false,\n      userInfo:{},\n    };\n  },\n  created() {\n    let hrefStr=window.location.href.toString();\n    hrefStr=hrefStr.substring(hrefStr.lastIndexOf('userInfo')+1,hrefStr.length);\n    this.userInfo=JSON.parse(hrefStr);\n    localStorage.setItem('userInfo',this.userInfo);\n    //获取管控平台小区列表\n    this.refresh();\n  },\n\n  computed: {\n    ...mapState({\n      areaList: state => state.permission.areaList,\n      areaCode: state => state.permission.areaCode\n    })\n  },\n\n  methods: {\n    ...mapMutations([\"setAreaList\", \"setAreaCode\"]),\n    goBack() {\n      this.$router.back();\n    },\n\n    // 刷新页面\n    refresh() {\n      if (this.areaList.length) {\n        this.selectedArea();\n      } else {\n        this.getSystemAreaList();\n      }\n    },\n\n    getSystemAreaList() {\n      getSystemDicByParent()\n        .then(res => {\n          this.showErrorPage = false;\n          console.log(\"获取管控平台小区列表成功:\", res);\n          this.setAreaList(res.data.list);\n          this.selectedArea();\n        })\n        .catch(err => {\n          this.showErrorPage = true;\n          err && this.$toast(err);\n          console.log(\"获取管控平台小区列表失败：\", err);\n        });\n    },\n\n    //选中小区\n    selectedArea() {\n      //用户重复进入 且未切换小区\n      if (this.areaCode === this.userInfo.AREA_CODE) {\n        const controlToken = storage.getStorage(\"controlToken\");\n        if (!controlToken.$s_code_$exp) {\n          //  页面跳转\n          this.jumpPage();\n        } else {\n          this.getControlToken(() => {\n            this.jumpPage();\n          });\n        }\n      } else {\n        //小区已经切换，需要重新获取controlToken\n        this.setAreaCode(\"\");\n        this.areaList.forEach(element => {\n          const newE = JSON.parse(element.remark);\n          if (newE.AREA_CODE === this.userInfo.AREA_CODE) {\n            //记录选中的小区\n            this.setAreaCode(newE.AREA_CODE);\n            storage.setStorage(\"xtBaseUrl\", newE.BASE_URL, 999);\n            this.getControlToken(() => {\n              this.jumpPage();\n            });\n          }\n        });\n\n        if (!this.areaCode) {\n          this.showErrorPage = true;\n          this.$toast(\"无法查到该小区信息\");\n        }\n      }\n    },\n\n    //获取管控平台token\n    getControlToken(fun) {\n      let data = {\n        roleId: 999,\n        userCode: this.userInfo.OWNER_CODE,\n        phone: this.userInfo.PHONE,\n        ownerName: this.userInfo.OWNER_NAME,\n        ownerNickName: this.userInfo.OWNER_NICK_NAME\n      };\n      getControlTokenService(data)\n        .then(res => {\n          console.log('获取controlToken成功:',res);\n          if (res.code === 200) {\n            // 成功\n            const { token } = res.data;\n            storage.setStorage(\"controlToken\", token, 999);\n            fun && fun();\n          } else {\n            this.showErrorPage = true;\n            res.message && this.$toast(res.message);\n          }\n        })\n        .catch(err => {\n          console.log('获取controlToken失败:',err);\n          this.showErrorPage = true;\n          this.$toast(\"获取管控平台token失败\");\n        });\n    },\n\n    jumpPage() {\n      this.$router.push({ name: \"register\" });\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.fault-page {\n  width: 100%;\n  height: 100%;\n  background-color: #f9f9f9;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n  .content-img {\n    padding-top: 30%;\n    img {\n      width: 160px;\n      height: 160px;\n    }\n  }\n\n  .content-describe {\n    font-family: PingFangSC-Regular;\n    font-size: 16px;\n    color: #9a9a9a;\n    letter-spacing: 0.06px;\n    margin-top: 26px;\n  }\n\n  .btn-content {\n    display: flex;\n    width: 60%;\n    justify-content: space-between;\n    .btn {\n      font-family: PingFangSC-Medium;\n      font-size: 14px;\n      color: #ffffff;\n      letter-spacing: -0.04px;\n      background: #fb5768;\n      border: 1px solid #fb5768;\n      border-radius: 14.5px;\n      width: 92px;\n      height: 30px;\n      line-height: 30px;\n      margin-top: 16px;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=1736da2c&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=1736da2c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1736da2c\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=1736da2c&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=1736da2c&lang=scss&scoped=true&\"","module.exports = __webpack_public_path__ + \"www/img/no_unable_load_img.ff3a271c.png\";"],"sourceRoot":""}