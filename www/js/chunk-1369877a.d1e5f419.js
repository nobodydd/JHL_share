(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1369877a"],{2627:function(e,t,s){},"37b7":function(e,t,s){"use strict";var a=s("618b"),n=s.n(a);n.a},"4f11":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAqhJREFUeAHtms1L1UEUhtX8IJUwEEGiRKggEqGNiwpx08qiaOEmMKE2QctyIfQXRGAtxJ0o1CYEEaTCRYsgqEUgRAWChIohRBpEH1TengMOHIZWwoHD3HPgZebcO8yc5x283pnframJCAfCgXAgHAgHwoFwIBwIB8KBcMChA5VKpRu9QJto2GGJdiUB3Is+oRTrdqs5mxnifrSdyHfbGWdl2pQD7CX0I4OfJq+3WdHRrEBeR38y+LvktY7KtCkFyLEMfIf8ls1qjmaV3UX3M/jf5FcdlWlTCpAN6FEG/5180GZFR7MC2YqeZfBfyE87KtOmFCDb0esMfp38pM2KjmYFsgt9QDokP+KoTJtSgOxBstM6XpG026zoaFYgzyD5G9fxlKTFUZk2pQB5Hsmnu46HJA02KzqaFcgRJP/XdYyTVMW3u1FNvdsfc7Q/NqXI7qJ7Gbx8x79ms6KjWYGsRzMZvJzuLjoq06YUIJvRQgYv5/p+mxWdzQroXAa/Qd7rrEy7coBdzQyYsFvN4czAX0H5hcYkr9U5LNemJGAvo59Ix2OSRpsVHc4K7AD6qh2gv4haHZZrUxKwp5Dc5+uQI3D5B59kKbBH0Yp2gP57dDiNKb4FthMtIR1rJCeKh0+AwLYhecSl4zNJXxpTfAvsfjSvHaD/DZ0rHj4BAivnhCmk4xfJUBpTfAusnBTlaY+OvyQ3iofXgADfRvL0R8cdPab4PuT/uy16wOvl3xal3QX2AsrvC+VpUfn3hcqEswBvIR1PSJrTmOJbYOUXIXJ/oOMlycHi4RMgsN1oWTtA/y06lMYU3wLbgd4gHR9JjhUPnwCBPYCeIx1L6f2qaCFvQrPKgXdVAa4hgd+HbiL5Bclx/V70w4FwIBwIB8KBcCAcCAfCgXBgzw78A2Wj4+ezw0gaAAAAAElFTkSuQmCC"},"55e8":function(e,t,s){e.exports=s.p+"www/img/noSource.ef090043.png"},"618b":function(e,t,s){},"960f":function(e,t,s){"use strict";var a=s("2627"),n=s.n(a);n.a},"9be0":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"system-message-page"},[a("navigation-bar",{attrs:{pageName:e.title,bothWidth:e.headerItemWidth},on:{onLeftClick:e.onBack},scopedSlots:e._u([{key:"nav-right",fn:function(){return[a("div",{staticClass:"rightBtn",on:{click:e.messageMarkRead}},[e._v(e._s(e.rightName))])]},proxy:!0}])}),a("div",{staticClass:"message-list"},[a("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[a("van-list",{directives:[{name:"show",rawName:"v-show",value:!(e.contentLoaded&&0==e.messageList.length),expression:"!(contentLoaded && messageList.length == 0)"}],attrs:{error:e.error,"error-text":"请求失败，点击重新加载",finished:e.finished,"finished-text":e.messageList.length>0?"无更多数据...":"",offset:356,"immediate-check":!1},on:{"update:error":function(t){e.error=t},load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.messageList,(function(t,n){return a("div",{key:n,staticClass:"message-cell",on:{click:function(s){return e.jumpNoticeContent(t,n)}}},[1!=t.isRead?a("img",{staticClass:"read-status-icon",attrs:{src:s("f201"),alt:""}}):e._e(),a("div",{staticClass:"cell-top",style:1!=t.isRead?"padding-top: 3px":"padding-top: 15px"},[a("div",{staticClass:"text-content"},[a("div",{staticClass:"text-title",style:1!=t.isRead?"color: #333333":"color: #C8C8C8"},[e._v(e._s(t.systemName))])]),a("div",{staticClass:"cell-right"},[a("div",{style:1!=t.isRead?"color: #9A9A9A":"color: #C8C8C8"},[e._v(e._s(t.sendTime))])])]),a("div",{staticClass:"cell-bottom"},[a("div",{style:1!=t.isRead?"color: #333333; margin-bottom: 12px":"color: #C8C8C8; margin-bottom: 12px"},[e._v(e._s(t.sendMessage))])])])})),0),a("div",{directives:[{name:"show",rawName:"v-show",value:e.contentLoaded&&0==e.messageList.length,expression:"contentLoaded && messageList.length == 0"}],staticClass:"no-list"},[a("img",{attrs:{src:e.noSourceImg,alt:""}}),a("div",{staticClass:"no-text"},[e._v("暂无消息")])])],1)],1),a("van-dialog",{attrs:{confirmButtonColor:"#00d8d1",message:e.dialogMessage,"show-cancel-button":"",beforeClose:e.beforeClose},model:{value:e.isShowDialog,callback:function(t){e.isShowDialog=t},expression:"isShowDialog"}})],1)},n=[],o=(s("ac6a"),s("35d6")),i=s("2b0e"),r=s("ad06"),c=s("2bdd"),d=s("58e6"),g=s("da6f"),l=s("da6a"),u=s("55e8"),h=s.n(u);i["default"].use(r["a"]).use(c["a"]).use(d["a"]);var f={name:"SystemNotice",components:{NavigationBar:l["a"]},created:function(){},activated:function(){if(this.$route.params.fromHome){var e=g["b"].get("custNews");this.userInfo=e||g["a"].getStorage("custNews"),this.pageNum=1,this.currentItem={},this.noteIndex=0,this.messageList=[],this.scrollTop=0,this.unReadMsgCount=0,this.getNoticeList(!0)}else document.querySelector(".message-list").scrollTop=this.scrollTop,this.updateCurrentNoticeInfo();this.getUnreadCount()},data:function(){return{active:0,title:"消息中心",rightName:"",headerItemWidth:{width:"100PX"},messageList:[],refreshing:!1,loading:!1,finished:!1,error:!1,pageNum:1,pageSize:10,contentLoaded:!1,isShowDialog:!1,dialogMessage:"确认全部已读？",readedNotices:[],noSourceImg:h.a,userInfo:{},currentItem:{},noteIndex:0,scrollTop:0,unReadMsgCount:0,unReadRefreshEnd:!0,msgListRefreshEnd:!0}},methods:{onBack:function(){this.currentItem={},this.noteIndex=0,this.scrollTop=0,this.unReadMsgCount=0,this.$router.back(-1)},messageMarkRead:function(){0!=this.messageList.length&&(this.isShowDialog=!0)},beforeClose:function(e,t){"confirm"===e&&this.setMessageReaded(),t()},setMessageReaded:function(){var e=this,t={userCode:this.userInfo.USER_CODE};Object(o["d"])(t).then((function(t){0==t.resultCode?(e.showMsg(t.msg),document.querySelector(".message-list").scrollTop=0,e.onRefresh(),e.unReadMsgCount=0,console.log("消息设置为全部已读成功。")):console.log("消息设置已读失败。")})).catch((function(t){e.showMsg(t)}))},jumpNoticeContent:function(e,t){this.currentItem=e,this.noteIndex=t,this.scrollTop=document.querySelector(".message-list").scrollTop,this.$router.push({name:"NoticeDetail",params:{noticeReq:e}})},getNoticeList:function(e){var t=this;this.msgListRefreshEnd=!1;var s={ownerCode:this.userInfo.USER_CODE,page:this.pageNum,rows:10};Object(o["b"])(s).then((function(s){t.loading=!1,e&&(t.finished=!1,t.refreshing=!1,t.messageList=[]),0==s.resultCode?(void 0!=s.data&&void 0!=s.data.list&&s.data.list.length>0&&(s.data.list.forEach((function(e){t.messageList.push(e)})),t.rightName="全部标为已读"),s.data&&t.pageNum*t.pageSize>=s.data.total&&(t.finished=!0,t.loading=!1,t.refreshing=!1),t.pageNum++,t.contentLoaded=!0):(t.loading=!1,t.refreshing=!1,t.error=!0,t.contentLoaded=!0,console.log("请求数据失败."))})).catch((function(e){t.loading=!1,t.refreshing=!1,t.error=!0,t.contentLoaded=!0,t.showMsg(e)})).finally((function(){t.unReadRefreshEnd&&(t.messageList.length>0&&t.unReadMsgCount>0&&!t.rightName?t.rightName="全部标为已读":(t.messageList.length<=0||t.unReadMsgCount<=0)&&t.rightName&&(t.rightName="")),t.msgListRefreshEnd=!0}))},onLoad:function(){this.contentLoaded&&(this.error=!1,this.loading=!0,this.getNoticeList(!1))},onRefresh:function(){this.error=!1,this.loading=!1,this.pageNum=1,this.currentItem={},this.noteIndex=0,this.messageList=[],this.scrollTop=0,this.unReadMsgCount=0,this.getNoticeList(!0),this.getUnreadCount()},showMsg:function(e){this.$toast(e)},updateCurrentNoticeInfo:function(){var e=this;Object(o["a"])({id:this.currentItem.messageId}).then((function(t){0==t.resultCode?e.$set(e.messageList,e.noteIndex,t.data):console.log("update current msg failed.")})).catch((function(e){console.log(e)}))},getUnreadCount:function(){var e=this;this.unReadRefreshEnd=!1,Object(o["c"])({userCode:this.userInfo.USER_CODE}).then((function(t){0==t.resultCode?e.unReadMsgCount=t.data.unReadMsgCount:console.log("get unread msg count failed.")})).catch((function(e){console.log("get unread msg count failed for "+e)})).finally((function(){e.msgListRefreshEnd&&(e.messageList.length>0&&e.unReadMsgCount>0&&!e.rightName?e.rightName="全部标为已读":(e.messageList.length<=0||e.unReadMsgCount<=0)&&e.rightName&&(e.rightName="")),e.unReadRefreshEnd=!0}))}}},m=f,A=(s("37b7"),s("2877")),p=Object(A["a"])(m,a,n,!1,null,"d342e202",null);t["default"]=p.exports},da6a:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"navBar van-nav-bar",style:e.navBarStyle},[e.isShowLeft?s("div",{staticClass:"left",style:e.bothWidth,on:{click:function(t){return e.$emit("onLeftClick")}}},[e.isShowBack?s("img",{attrs:{src:e.backImg,alt:"",srcset:""}}):e._e(),e._t("nav-left")],2):e._e(),s("div",{staticClass:"center"},[e.isDefault?s("span",{staticClass:"title"},[e._v(e._s(e.pageName))]):e._e(),e._t("nav-center")],2),e.isShowRight?s("div",{staticClass:"right",style:e.bothWidth},[e._t("nav-right")],2):e._e()])},n=[],o={props:{isDefault:{default:!0,type:Boolean},bothWidth:{type:Object,default:function(){return{width:"36px"}}},isShowRight:{default:!0,type:Boolean},isShowLeft:{default:!0,type:Boolean},isShowBack:{default:!0,type:Boolean},leftImgType:{type:String,default:"0"},pageName:{default:"",type:String},navBarStyle:{type:Object,default:function(){return{backgroundColor:"#fff"}}}},data:function(){return{backImg:s("4f11")}},mounted:function(){this.isLeftImg()},methods:{isLeftImg:function(){switch(this.leftImgType){case"0":this.backImg=s("4f11");break;case"1":this.backImg=s("4f11");break}}}},i=o,r=(s("960f"),s("2877")),c=Object(r["a"])(i,a,n,!1,null,"7e35d797",null);t["a"]=c.exports},f201:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAALGPC/xhBQAAAHVJREFUSA211jkOwCAQA0D4Ih9KXk6ipUAK4djDdufG0zo/pdyp1iuRkmWXiTSAiXSAhXwABvID0MgUQCJLAIVsAQRyBKKICoggasCLmAAPYgasiAuwIG5Ai4QADRIGTggE2CEwYIVAgRkCB0aEAoyIdErkrbyH82xt+m3IqwAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=chunk-1369877a.d1e5f419.js.map