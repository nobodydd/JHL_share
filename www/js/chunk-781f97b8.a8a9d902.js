(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-781f97b8"],{"1ad7":function(e,t,r){"use strict";var o=r("cfa7"),n=r.n(o);n.a},"49fb":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"show",rawName:"v-show",value:e.showErrorPage,expression:"showErrorPage"}],staticClass:"fault-page"},[r("div",{staticClass:"content-img"},[r("img",{attrs:{src:e.defaultImg,alt:""}})]),r("div",{staticClass:"content-describe"},[e._v("哎呀，报错了…")]),r("div",{staticClass:"btn-content"},[r("div",{staticClass:"btn",on:{click:e.refresh}},[e._v("刷新页面")]),r("div",{staticClass:"btn",on:{click:e.goBack}},[e._v("返回主页")])])])},n=[],s=(r("8e6e"),r("456d"),r("ac6a"),r("bd86")),a=(r("6b54"),r("2b69")),i=r("96e6"),c=function(e){return a["a"].get("/web/new/api/user/appOwnerLoginNew",e)},u=function(){return a["a"].get(i["a"]+"/subsystem/system/dic/getSystemDicByParentIdContent1",{parentId:"PH",pageSize:"100",pageNum:"1"})},f=r("8940"),l=r.n(f),g=r("da6f"),h=r("ae8c");function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(r,!0).forEach((function(t){Object(s["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var w={data:function(){return{defaultImg:l.a,showErrorPage:!1,userInfo:{}}},created:function(){var e=window.location.href.toString();e=e.substring(e.lastIndexOf("userInfo=")+1,e.length),this.userInfo=JSON.parse(e),localStorage.setItem("userInfo",this.userInfo),this.refresh()},computed:p({},Object(h["c"])({areaList:function(e){return e.permission.areaList},areaCode:function(e){return e.permission.areaCode}})),methods:p({},Object(h["b"])(["setAreaList","setAreaCode"]),{goBack:function(){this.$router.back()},refresh:function(){this.areaList.length?this.selectedArea():this.getSystemAreaList()},getSystemAreaList:function(){var e=this;u().then((function(t){e.showErrorPage=!1,console.log("获取管控平台小区列表成功:",t),e.setAreaList(t.data.list),e.selectedArea()})).catch((function(t){e.showErrorPage=!0,t&&e.$toast(t),console.log("获取管控平台小区列表失败：",t)}))},selectedArea:function(){var e=this;if(this.areaCode===this.userInfo.AREA_CODE){var t=g["a"].getStorage("controlToken");t.$s_code_$exp?this.getControlToken((function(){e.jumpPage()})):this.jumpPage()}else this.setAreaCode(""),this.areaList.forEach((function(t){var r=JSON.parse(t.remark);r.AREA_CODE===e.userInfo.AREA_CODE&&(e.setAreaCode(r.AREA_CODE),g["a"].setStorage("xtBaseUrl",r.BASE_URL,999),e.getControlToken((function(){e.jumpPage()})))})),this.areaCode||(this.showErrorPage=!0,this.$toast("无法查到该小区信息"))},getControlToken:function(e){var t=this,r={roleId:999,userCode:this.userInfo.OWNER_CODE,phone:this.userInfo.PHONE,ownerName:this.userInfo.OWNER_NAME,ownerNickName:this.userInfo.OWNER_NICK_NAME};c(r).then((function(r){if(console.log("获取controlToken成功:",r),200===r.code){var o=r.data.token;g["a"].setStorage("controlToken",o,999),e&&e()}else t.showErrorPage=!0,r.message&&t.$toast(r.message)})).catch((function(e){console.log("获取controlToken失败:",e),t.showErrorPage=!0,t.$toast("获取管控平台token失败")}))},jumpPage:function(){this.$router.push({name:"register"})}})},b=w,m=(r("1ad7"),r("2877")),O=Object(m["a"])(b,o,n,!1,null,"76a920fe",null);t["default"]=O.exports},8940:function(e,t,r){e.exports=r.p+"www/img/no_unable_load_img.ff3a271c.png"},cfa7:function(e,t,r){}}]);
//# sourceMappingURL=chunk-781f97b8.a8a9d902.js.map