{"version":3,"sources":["webpack:///./src/assets/imgs/back_img.png","webpack:///./src/components/login/Login.vue?db55","webpack:///src/components/login/Login.vue","webpack:///./src/components/login/Login.vue?0816","webpack:///./src/components/login/Login.vue?f8ba","webpack:///./src/components/login/Login.vue?2ad1"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","staticClass","style","on","loginTextClicked","_v","loginType","directives","name","rawName","value","expression","attrs","domProps","$event","target","composing","phoneNum","phoneCode","sendPhoneCode","_s","verifyCodeStr","passWd","_e","login","staticStyle","updateCount","switchNewPasswd","envSwitchActions","onSelect","onCancel","model","callback","$$v","isShowenvSwitch","staticRenderFns","data","debug","timeStart","timeVerify","clockID","id","back","loginStyle","backgroundImage","backgroundSize","backgroundRepeat","envSelectIndex","versonClickCount","publicKey","rsaPassWord","methods","checkUserData","getPubKey","resetData","log","updateUserInfo","obj","store","$router","replace","AREA_CODE","custNews","USER_CODE","console","JSON","stringify","undefined","showMsg","basePassWord","$getRSASign","rsaInfo","rsaPhoneInfo","$toast","msg","loginSuccess","resultCode","EMAIL","email","PHONE","phone","PIC_BG_URL","picBgUrl","PIC_URL","picUrl","TEL","tel","USER_ACCNT","userAccnt","userCode","USER_NAME","userName","USER_NICK_NAME","userNickName","sales_man_flag","salesManFlag","operation_flag","operationFlag","deptCode","accessToken","successMsg","loginXtSystem","resultMsg","loginFailed","errorMsg","error","push","window","clearInterval","message","item","index","envChangedCallBack","envData","config","$plugin","usePlugin","appUrl","homeUrl","roleId","activated","component"],"mappings":"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","file":"www/js/chunk-10e348d9.702a2bb5.js","sourcesContent":["module.exports = __webpack_public_path__ + \"www/img/back_img.d7b20175.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login\",style:(_vm.loginStyle)},[_c('div',{staticClass:\"loginHeader\"}),_c('div',{staticClass:\"loginTitle\",on:{\"click\":_vm.loginTextClicked}},[_vm._v(\"登录\")]),(_vm.loginType === 0)?_c('div',{staticClass:\"loginArea\"},[_c('div',{staticClass:\"phoneArea\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.phoneNum),expression:\"phoneNum\"}],staticClass:\"phoneInput\",attrs:{\"onkeyup\":\"value=value.replace(/[^\\\\d]/g,'')\",\"maxlength\":\"11\",\"type\":\"text\",\"placeholder\":\"手机号\"},domProps:{\"value\":(_vm.phoneNum)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.phoneNum=$event.target.value}}})]),_c('div',{staticClass:\"checkArea\"},[_c('div',{staticClass:\"check_code_div\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.phoneCode),expression:\"phoneCode\"}],staticClass:\"checkInput\",attrs:{\"type\":\"text\",\"placeholder\":\"验证码\"},domProps:{\"value\":(_vm.phoneCode)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.phoneCode=$event.target.value}}}),_c('div',{staticClass:\"checkButton\",on:{\"click\":function($event){return _vm.sendPhoneCode($event)}}},[_vm._v(\"  \"+_vm._s(_vm.verifyCodeStr)+\"  \")])])])]):(_vm.loginType == 1)?_c('div',{staticClass:\"loginArea\"},[_c('div',{staticClass:\"phoneArea\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.phoneNum),expression:\"phoneNum\"}],staticClass:\"phoneInput\",attrs:{\"onkeyup\":\"value=value.replace(/[^\\\\d]/g,'')\",\"maxlength\":\"11\",\"type\":\"text\",\"placeholder\":\"账号\"},domProps:{\"value\":(_vm.phoneNum)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.phoneNum=$event.target.value}}})]),_c('div',{staticClass:\"checkArea\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.passWd),expression:\"passWd\"}],staticClass:\"phoneInput\",attrs:{\"type\":\"password\",\"placeholder\":\"密码\"},domProps:{\"value\":(_vm.passWd)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.passWd=$event.target.value}}})])]):_vm._e(),_c('div',{staticClass:\"loginBut\",attrs:{\"plain\":\"\"},on:{\"click\":_vm.login}},[_vm._v(\"登录\")]),_c('div',{staticClass:\"loginButton\"},[_c('div',{staticClass:\"changLoign\",staticStyle:{\"float\":\"left\"},on:{\"click\":_vm.updateCount}},[_vm._v(\"切换登录方式\")]),_c('div',{staticClass:\"changLoign\",staticStyle:{\"float\":\"right\"},on:{\"click\":_vm.switchNewPasswd}},[_vm._v(\"忘记密码\")])]),_c('van-action-sheet',{attrs:{\"round\":true,\"safe-area-inset-bottom\":true,\"actions\":_vm.envSwitchActions,\"cancel-text\":\"取消\"},on:{\"select\":_vm.onSelect,\"cancel\":_vm.onCancel},model:{value:(_vm.isShowenvSwitch),callback:function ($$v) {_vm.isShowenvSwitch=$$v},expression:\"isShowenvSwitch\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"login\" :style=\"loginStyle\">\n    <div class=\"loginHeader\"></div>\n    <div class=\"loginTitle\" @click=\"loginTextClicked\">登录</div>\n    <div class=\"loginArea\" v-if=\"loginType === 0\">\n      <div class=\"phoneArea\">\n        <input\n          class=\"phoneInput\"\n          onkeyup=\"value=value.replace(/[^\\d]/g,'')\"\n          maxlength=\"11\"\n          type=\"text\"\n          placeholder=\"手机号\"\n          v-model=\"phoneNum\"\n        />\n      </div>\n      <!--<div class=\"line-div\"></div>-->\n      <div class=\"checkArea\">\n        <div class=\"check_code_div\">\n          <input type=\"text\" class=\"checkInput\" placeholder=\"验证码\" v-model=\"phoneCode\" />\n          <div\n            class=\"checkButton\"\n            @click=\"sendPhoneCode($event)\"\n          >&nbsp;&nbsp;{{verifyCodeStr}}&nbsp;&nbsp;</div>\n        </div>\n        <!--<div class=\"check-line-div\"></div>-->\n      </div>\n    </div>\n    <div class=\"loginArea\" v-else-if=\"loginType == 1\">\n      <div class=\"phoneArea\">\n        <input\n          class=\"phoneInput\"\n          onkeyup=\"value=value.replace(/[^\\d]/g,'')\"\n          maxlength=\"11\"\n          type=\"text\"\n          placeholder=\"账号\"\n          v-model=\"phoneNum\"\n        />\n      </div>\n      <!--<div class=\"line-div\"></div>-->\n      <div class=\"checkArea\">\n        <input class=\"phoneInput\" type=\"password\" placeholder=\"密码\" v-model=\"passWd\" />\n      </div>\n      <!--<div class=\"line-div\"></div>-->\n    </div>\n    <div class=\"loginBut\" @click=\"login\" plain>登录</div>\n    <div class=\"loginButton\">\n      <div class=\"changLoign\" @click=\"updateCount\" style=\"float: left\">切换登录方式</div>\n      <div class=\"changLoign\" @click=\"switchNewPasswd\" style=\"float: right\">忘记密码</div>\n    </div>\n\n    <!-- 环境切换选择框 -->\n    <van-action-sheet\n      v-model=\"isShowenvSwitch\"\n      :round=\"true\"\n      :safe-area-inset-bottom=\"true\"\n      :actions=\"envSwitchActions\"\n      cancel-text=\"取消\"\n      @select=\"onSelect\"\n      @cancel=\"onCancel\"\n    />\n  </div>\n</template>\n\n<script>\nimport {\n  loginByPassword,\n  getPhoneCode,\n  getPropertyUser,\n  loginByPropertyMsgCode,\n  updateCustNews,\n  getNowDate,\n  setAlias,\n  getRsaPublicKey,\n  deleteAlias,\n  cleanTags,\n  getControlTokenService\n} from \"../../services/loginService.js\";\nimport { store, storage } from \"../../utils/store\";\nimport log from \"../../utils/log.js\";\nimport { getUserInfoService } from \"../../services/mineService.js\";\nimport { custNews } from \"../../services/loginService\";\nimport Vue from \"vue\";\nimport { Dialog, Toast } from \"vant\";\nimport config from \"../../common/config\";\nVue.use(Dialog, Toast);\n\nexport default {\n  name: \"Login\",\n  data() {\n    return {\n      debug: false,\n      loginType: 1,\n      phoneNum: \"\",\n      passWd: \"\",\n      phoneCode: \"\",\n      timeStart: 0,\n      timeVerify: 0,\n      clockID: \"\",\n      id: \"0\",\n      verifyCodeStr: \"发送验证码\",\n      back: require(\"../../assets/imgs/back_img.png\"),\n      loginStyle: {\n        backgroundImage:\n          \"url(\" + require(\"../../assets/imgs/back_img.png\") + \")\",\n        backgroundSize: \"cover\",\n        backgroundRepeat: \"no-repeat\"\n      },\n      // 环境切换选择框\n      isShowenvSwitch: false,\n      envSelectIndex: \"666\",\n      envSwitchActions: [],\n      versonClickCount: 0,\n      publicKey: \"\", //公钥\n      rsaPassWord: \"\"\n    };\n  },\n  methods: {\n    updateCount: function() {\n      this.loginType = 1 - this.loginType;\n      this.phoneCode = \"\";\n      this.passWd = \"\";\n    },\n    checkUserData: function() {\n      this.getPubKey(false);\n      this.resetData();\n      const obj = storage.getStorage(\"custNews\");\n      if (\n        null !== obj &&\n        !obj.$s_code_$exp &&\n        \"数据不存在\" !== obj.message &&\n        \"数据已过期\" !== obj.message\n      ) {\n        updateCustNews(obj);\n        this.updateUserInfo(obj);\n        setAlias(obj);\n        store.set(\"currentTabIndex\", 0);\n        this.$router.replace({ path: \"home\" });\n      } else {\n        log.i(\n          \"Not login or login timeout, should login first.\" +\n            JSON.stringify(obj)\n        );\n      }\n    },\n    updateUserInfo: function(custNews) {\n      let userData = {\n        AREA_CODE: custNews.AREA_CODE,\n        USER_CODE: custNews.USER_CODE\n      };\n      getUserInfoService(userData)\n        .then(noteData => {\n          let userPic = noteData.PIC_URL;\n          if (userPic != \"\") {\n            custNews.PIC_URL = userPic;\n          }\n          custNews.USER_ACCNT = noteData.USER_ACCNT;\n          custNews.USER_NICK_NAME = noteData.USER_NICK_NAME;\n          custNews.PHONE = noteData.PHONE;\n          updateCustNews(custNews);\n        })\n        .catch(error => {\n          log.e(error);\n        });\n    },\n    login: function() {\n      if (!this.publicKey) {\n        console.log(\"key \" + JSON.stringify(this.publicKey));\n        this.getPubKey(true);\n        return;\n      }\n      if (1 === this.loginType) {\n        // 密码\n        if (undefined === this.phoneNum || \"\" === this.phoneNum) {\n          this.showMsg(\"账号不能为空\");\n          return;\n        } else if (\n          !/^(((11[0-9]{1})|(12[0-9]{1})|(13[0-9]{1})|(14[0-9]{1})|(15[0-9]{1})|(16[0-9]{1})|(17[0-9]{1})|(18[0-9]{1})|(19[0-9]{1}))+\\d{8})$/.test(\n            this.phoneNum\n          )\n        ) {\n          this.showMsg(\"请输入正确的手机号\");\n          return;\n        } else if (undefined === this.passWd || \"\" === this.passWd) {\n          this.showMsg(\"密码不能为空\");\n          return;\n        }\n        // login by password and phone\n        // todo: show loading view.\n        /*var loginData = {};\n        loginData.USER_ACCNT = this.phoneNum;\n        loginData.USER_PWD = this.passWd;\n        loginData.PHONE = this.phoneNum;*/\n        let basePassWord = btoa(this.passWd);\n        console.log(basePassWord);\n        let rsaInfo = this.phoneNum + \",\" + basePassWord + \",\" + \"10\";\n        this.rsaPassWord = this.$getRSASign(rsaInfo, this.publicKey);\n        log.i(this.rsaPassWord);\n        let loginInfo = this.rsaPassWord;\n        loginByPassword(loginInfo)\n          .then(loginResult => {\n            this.loginSuccess(loginResult);\n          })\n          .catch(error => {\n            this.loginFailed(error);\n          });\n      } else if (0 === this.loginType) {\n        // 验证码\n        if (undefined === this.phoneNum || \"\" === this.phoneNum) {\n          this.showMsg(\"手机号不能为空\");\n          return;\n        } else if (\n          !/^(((11[0-9]{1})|(12[0-9]{1})|(13[0-9]{1})|(14[0-9]{1})|(15[0-9]{1})|(16[0-9]{1})|(17[0-9]{1})|(18[0-9]{1})|(19[0-9]{1}))+\\d{8})$/.test(\n            this.phoneNum\n          )\n        ) {\n          this.showMsg(\"请输入正确的手机号\");\n          return;\n        } else if (undefined === this.phoneCode || \"\" === this.phoneCode) {\n          // if user never request phone code, the passWd will be empty, ignore.\n          this.showMsg(\"请输入验证码\");\n          return;\n        }\n        // verify code timeout\n        // backend will handle code timeout, ignore.\n        this.timeVerify = getNowDate();\n        // login by phone number and verify number\n        /*var codeLoginData = {};\n        codeLoginData.USER_ACCNT = this.phoneNum;\n        codeLoginData.PHONE = this.phoneNum;\n        codeLoginData.USER_PWD = this.phoneCode;\n        codeLoginData.VERIFICATION = this.phoneCode;*/\n        let rsaInfo = this.phoneNum + \",\" + this.phoneCode + \",\" + \"10\";\n        this.rsaPassWord = this.$getRSASign(rsaInfo, this.publicKey);\n        let loginInfo = this.rsaPassWord;\n        loginByPropertyMsgCode(loginInfo)\n          .then(loginResult => {\n            this.loginSuccess(loginResult);\n          })\n          .catch(error => {\n            this.loginFailed(error);\n          });\n      }\n    },\n    // get verify code\n    sendPhoneCode: function(event) {\n      if (undefined === this.phoneNum || \"\" === this.phoneNum) {\n        this.showMsg(\"手机号不能为空\");\n        return;\n      } else if (\n        !/^(((11[0-9]{1})|(12[0-9]{1})|(13[0-9]{1})|(14[0-9]{1})|(15[0-9]{1})|(16[0-9]{1})|(17[0-9]{1})|(18[0-9]{1})|(19[0-9]{1}))+\\d{8})$/.test(\n          this.phoneNum\n        )\n      ) {\n        this.showMsg(\"请输入正确的手机号\");\n        return;\n      }\n\n      // var timeStartFetchCode = \"\";/*点击获取验证码的时间*/\n      // var time2 = \"\";/*计算验证码时间间隔*/\n      var verifyCodeRequestData = {\n        PHONE: this.phoneNum\n      };\n      if (this.id === \"0\") {\n        // get verify code\n        // timeStartFetchCode = getNowDate();\n        // const msgCodeDebug = this.debug;\n        this.timeStart = getNowDate();\n        var userData = {\n          PHONE: this.phoneNum\n        };\n        if (!this.publicKey) {\n          console.log(\"key \" + JSON.stringify(this.publicKey));\n          this.getPubKey(false, true);\n          return;\n        }\n        let rsaInfo = this.phoneNum + \",\" + \"10\";\n        this.rsaPhoneInfo = this.$getRSASign(rsaInfo, this.publicKey);\n        log.i(this.rsaPhoneInfo);\n        let accntInfo = this.rsaPhoneInfo;\n        getPhoneCode(accntInfo)\n          .then(result => {\n            console.log(JSON.stringify(result));\n            if (result.resultCode == 0) {\n              this.id = \"1\";\n              try {\n                var totalTime = 60;\n                this.verifyCodeStr = totalTime + \"秒后重发\";\n                this.clockID = window.setInterval(() => {\n                  totalTime--;\n                  if (totalTime > 0) {\n                    this.verifyCodeStr = totalTime + \"秒后重发\";\n                  }\n                  if (totalTime <= 0) {\n                    window.clearInterval(this.clockID);\n                    this.verifyCodeStr = \"重发验证码\";\n                    totalTime = 60;\n                    this.id = \"0\";\n                  }\n                }, 1000);\n              } catch (e) {\n                this.showMsg(e);\n              }\n            } else {\n              this.showMsg(result.msg);\n            }\n          })\n          .catch(error => {\n            console.log(\"get phone code failed.\" + error);\n            this.showMsg(error);\n          });\n        // getPropertyUser(userData)\n        //   .then(result => {\n        //     if (\"1\" === result.success) {\n        //       // user property\n        //       getPhoneCode(verifyCodeRequestData)\n        //         .then(result => {\n        //           var returnData = result;\n        //           if (undefined == returnData) {\n        //             this.showMsg(\"获取验证码失败！\");\n        //             return;\n        //           }\n        //           if (true == returnData.success) {\n        //             this.id = \"1\";\n        //             try {\n        //               var totalTime = 60;\n        //               this.verifyCodeStr = totalTime + \"秒后重发\";\n        //               this.clockID = window.setInterval(() => {\n        //                 totalTime--;\n        //                 if (totalTime > 0) {\n        //                   this.verifyCodeStr = totalTime + \"秒后重发\";\n        //                 }\n        //                 if (totalTime <= 0) {\n        //                   window.clearInterval(this.clockID);\n        //                   this.verifyCodeStr = \"重发验证码\";\n        //                   totalTime = 60;\n        //                   this.id = \"0\";\n        //                 }\n        //               }, 1000);\n        //             } catch (e) {\n        //               this.showMsg(e);\n        //             }\n        //           } else {\n        //             this.showMsg(returnData.msg);\n        //           }\n        //         })\n        //         .catch(error => {\n        //           this.showMsg(error);\n        //         });\n        //     } else {\n        //       this.showMsg(result.msg);\n        //     }\n        //   })\n        //   .catch(error => {\n        //     this.showMsg(error);\n        //   });\n      } else {\n        this.showMsg(\"请稍后重试！\");\n      }\n    },\n    showMsg: function(msg) {\n      this.$toast(msg);\n    },\n    loginSuccess: function(msg) {\n      log.l(JSON.stringify(msg));\n      log.i(msg);\n      if (\"0\" == msg.resultCode) {\n        var custNews = {};\n        custNews.AREA_CODE = \"\";\n        custNews.AREA_NAME = \"\";\n        custNews.EMAIL = msg.data.email;\n        custNews.PHONE = msg.data.phone;\n        custNews.PIC_BG_URL = msg.data.picBgUrl;\n        custNews.PIC_URL = msg.data.picUrl;\n        custNews.TEL = msg.data.tel;\n        custNews.USER_ACCNT = msg.data.userAccnt;\n        custNews.USER_CODE = msg.data.userCode;\n        custNews.USER_NAME = msg.data.userName;\n        custNews.USER_NICK_NAME = msg.data.userNickName;\n        custNews.sales_man_flag = msg.data.salesManFlag;\n        custNews.operation_flag = msg.data.operationFlag;\n        custNews.deptCode = msg.data.deptCode;\n        updateCustNews(custNews);\n        storage.setStorage(\"custNews\", custNews, 60);\n        // save the token and refresh token from login data.\n        console.log(msg.data.accessToken);\n        //storage.setStorage(\"accessToken\", msg.data.accessToken, 0.08);\n        storage.setStorage(\"accessToken\", msg.data.accessToken, 0.1);\n        storage.setStorage(\"refreshToken\", msg.data.refreshToken, 30);\n        store.set(\"accessToken\", msg.data.accessToken);\n        store.set(\"refreshToken\", msg.data.refreshToken);\n        setAlias(custNews);\n        var successMsg = msg;\n        if (undefined == successMsg) {\n          successMsg = \"\";\n        }\n        store.set(\"currentTabIndex\", 0);\n\n        //管控平台登录\n        this.loginXtSystem(custNews, () => {\n          this.$router.replace({ path: \"home\" });\n        });\n      } else {\n        this.showMsg(msg.resultMsg);\n      }\n    },\n    loginFailed: function(error) {\n      var errorMsg = error;\n      if (\"网络异常！\" == errorMsg) {\n        this.showMsg(\"网络异常，请检查网络！\");\n      } else {\n        this.showMsg(\"登录失败, \" + errorMsg);\n      }\n      log.e(\"login failed for \" + errorMsg);\n      // todo: hide loading.\n    },\n    switchNewPasswd: function() {\n      this.$router.push(\"/passwdchange\");\n    },\n    resetData() {\n      this.debug = false;\n      this.loginType = 1;\n      this.phoneNum = \"\";\n      this.passWd = \"\";\n      this.phoneCode = \"\";\n      this.timeStart = 0;\n      this.timeVerify = 0;\n      this.verifyCodeStr = \"发送验证码\";\n      window.clearInterval(this.clockID);\n      this.clockID = \"\";\n      this.id = \"0\";\n    },\n    // 登录标题点击\n    loginTextClicked: function() {\n      // let versionName = config.version;\n      // if (versionName.indexOf(\"RC\") == -1 && versionName.indexOf(\"IT\") == -1\n      //         && versionName.indexOf(\"ST\") == -1 && versionName.indexOf(\"DEV\") == -1 && versionName.indexOf(\"VUE\") == -1) {\n      //   log.i(\"The version name is release version, do NOT support env switch logic \" + versionName);\n      //   return;\n      // }\n      // log.i(\"The version name is DEV version, support env switch logic \" + versionName);\n      this.versonClickCount++;\n      if (this.versonClickCount >= 10) {\n        this.versonClickCount = 0;\n        Dialog.confirm({\n          message: \"是否要修改网络环境？\"\n        })\n          .then(() => {\n            let currentColor = \"#07c160\";\n            let otherColor = \"#007aff\";\n            let envNames = Object.getOwnPropertyNames(config.urlMap);\n            // 获取当前环境key\n            let custUrl = store.get(\"custUrl\");\n            let envArray = [];\n            let envEle = {};\n            for (let index = 0; index < envNames.length; index++) {\n              envEle = config.urlMap[envNames[index]];\n              envArray.push({\n                name: envEle.envName,\n                color: custUrl.key === envEle.key ? currentColor : otherColor,\n                index: envEle.key\n              });\n            }\n            this.envSwitchActions = envArray;\n            this.isShowenvSwitch = true;\n          })\n          .catch(() => {\n            // cancel on\n          });\n      }\n    },\n    // 环境切换选择\n    onSelect(item) {\n      this.isShowenvSwitch = false;\n      this.envSelectIndex = item.index;\n      this.envChangedCallBack();\n    },\n    // 环境切换取消\n    onCancel() {\n      //  点击取消\n    },\n    // 环境切换成功方法回调\n    envChangedCallBack() {\n      let envData = \"\";\n      envData = config.urlMap[this.envSelectIndex];\n      store.set(\"custUrl\", envData);\n      storage.setStorage(\"custUrl\", envData, 365);\n      this.$plugin.usePlugin(\"Broadcast\")(\"ServiceEnvAdressChange\", {\n        appUrl: envData.homeUrl\n      });\n      Toast(\"环境切换成功!\");\n    },\n    getPubKey(forLogin, forPhoneCode) {\n      getRsaPublicKey()\n        .then(res => {\n          this.publicKey = res.data.publicKey;\n          if (forLogin) {\n            console.log(\"get pub key for login.\");\n            this.login();\n          }\n          if (forPhoneCode) {\n            console.log(\"get pub key for phone code.\");\n            this.sendPhoneCode();\n          }\n        })\n        .catch(error => {\n          // this.showMsg(error);\n          console.log(\"get pub key failed \" + error);\n          if (forLogin) {\n            console.log(\"get pub key for login.\" + error);\n            if (\"网络异常！\" == error) {\n              this.showMsg(\"网络异常，请检查网络！\");\n            } else {\n              this.showMsg(\"登录失败~\");\n            }\n          }\n          if (forPhoneCode) {\n            console.log(\"get pub key for phone code.\" + error);\n            if (\"网络异常！\" == error) {\n              this.showMsg(\"网络异常，请检查网络！\");\n            } else {\n              this.showMsg(\"验证码获取失败~\");\n            }\n          }\n        });\n    },\n    // ****** 三通登陆拦截 ******\n    loginXtSystem(custNews, fun) {\n      // debugger\n      let data = {\n        roleId: 999,\n        userCode: custNews.USER_CODE,\n        userAccnt: custNews.USER_ACCNT,\n        phone: custNews.PHONE,\n        userName: custNews.USER_NAME,\n        userNickName: custNews.USER_NICK_NAME\n      };\n      getControlTokenService(data)\n        .then(res => {\n          console.log(\"获取管控平台token\", res);\n          console.log(\"1213\", res);\n          if (res.code === 200) {\n            // 成功\n            const { token } = res.data;\n            storage.setStorage(\"controlToken\", token, 999);\n          } else {\n            res.message && this.showMsg(res.message);\n          }\n          fun && fun();\n        })\n        .catch(err => {\n          console.log(\"1213\", res);\n          this.showMsg(\"当前网络不可用\");\n          fun && fun();\n        });\n    }\n  },\n  activated() {\n    // call check user data when module created.\n    this.checkUserData();\n  }\n};\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n.login {\n  height: 100%;\n  padding-left: 20px;\n  padding-right: 20px;\n}\n\n.login .loginHeader {\n  height: 110px;\n}\n\n.login .loginTitle {\n  font-size: 28px;\n  padding-bottom: 23px;\n}\n\n.login .loginArea {\n  margin-top: 23px;\n}\n\n.login .loginArea .phoneArea {\n  width: 100%;\n}\n\n.login .checkArea {\n  position: relative;\n  width: 100%;\n  margin-top: 23px;\n  height: 30px;\n}\n\n.login .phoneInput {\n  margin-left: 5px;\n  width: 100%;\n  background-color: transparent;\n  font-size: 14px;\n  border-bottom: 1px solid #dbdbdb;\n  border-top: 0px;\n  border-left: 0px;\n  border-right: 0px;\n}\n\n.login .checkArea .checkInput {\n  margin-left: 5px;\n  width: 235px;\n  height: 30px;\n  background-color: transparent;\n  font-size: 14px;\n  border-bottom: 1px solid #dbdbdb;\n  border-top: 0px;\n  border-left: 0px;\n  border-right: 0px;\n  vertical-align: top;\n}\n\n.login .checkArea .check_code_div {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: end;\n  /*justify-content: space-around;*/\n  margin-top: 23px;\n}\n\n.login .loginBut {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 40px;\n  margin-top: 23px;\n  font-size: 14px;\n  color: #fff;\n  background-color: #00d8d1;\n  border-color: #00d8d1;\n  border-radius: 5px;\n  -moz-box-shadow: 5px 5px 5px #888888;\n  box-shadow: 5px 5px 5px #888888;\n}\n\n.login .loginButton {\n  margin-top: 15px;\n}\n\n.login .changLoign {\n  font-size: 14px;\n  padding-top: 14px;\n  color: #fff;\n}\n\n.login .checkArea .checkButton {\n  position: absolute;\n  width: auto;\n  text-align: center;\n  height: 30px;\n  font-size: 12px;\n  color: #fff;\n  background-color: #00d8d1;\n  border-radius: 15px;\n  line-height: 30px;\n  flex-wrap: nowrap;\n  right: 0px;\n}\n\n.line-div {\n  bottom: 0px;\n  width: 335px;\n  height: 1px;\n  border-top: solid #dbdbdb 1px;\n  display: none;\n}\n\n.check-line-div {\n  margin-top: -5px;\n  bottom: 0px;\n  width: 235px;\n  height: 1px;\n  border-top: solid #dbdbdb 1px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=62cc26a8&scoped=true&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Login.vue?vue&type=style&index=0&id=62cc26a8&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"62cc26a8\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=62cc26a8&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=62cc26a8&scoped=true&lang=css&\""],"sourceRoot":""}